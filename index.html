<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>News Breeze</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- css link -->
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
    <!-- font awesome  link -->
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <!-- bootstrap link -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
</head>
<body>

<!--trying Jumbutron-->

<div class="jumbotron">
    <!-- <div class="logo"> 
        <a href="index.html">
            <img src="assets/images/logo.png" alt="News Breeze">
        </a> 
    </div> -->
    <!-- nav box has search box, signin or register for the first time which leads to a different page
    and  option dropdown to select how many articles should be displayed from 1-15
    default is 5  -->
     <nav class="nav-box">
        <input class="search" placeholder="search">
        <a class="signin" href="./auth.html">Sign in or Sign up</a>
        <a class="signin" href="./auth-logout.html">Log Out</a>
        <select> 
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
        </select>
       
    </nav>
</header>
<div class="header-ext">
<div class="announcement">
    News Breeze let's you pick the news from specific sites and also share and personalize your favourite articles.
</div>
</div>
  </div>

  
<!-- main content of the news breeze page-->
<div class="stories">
    <div class="title-box">
        <h2>Today's top Stories </h2>
    </div>
    <!-- dynamic code generated using javascript -->
    <div class="container">
            <div class="row" id="main-content">
              <!-- <div class=" grow col-sm-3 col-md-3 col-xs-12" id="col0">
                 <img class="article" src=""> 
                
                 <div>
                    <span class="read">
                        <a class= "read" href="">Read more..</a>
                    </span>
                </div>
                <div class="action-container">
                    <a href="" class="far fa-bookmark"></a>
                    <a href="" class="far fa-share-square"></a>
                </div>
              </div> 
              <div class="grow col-sm-3 col-md-3 col-xs-12">
                 <img class="article" src="">
                
                <div>
                    <span class="read">
                        <a class= "read" href="">Read more..</a>
                    </span>
                </div>
                <div class="action-container">
                    <a href="" class="far fa-bookmark"></a>
                    <a href="" class="far fa-share-square"></a>
                </div>
              </div> 
              <div class="col-sm-3 col-md-3 col-xs-12">
                <img class="article"src="">      
                
                <div>
                    <span class="read">
                        <a class= "read" href="">Read more..</a>
                    </span>
                </div>
                <div class="action-container">
                    <a href="" class="far fa-bookmark"></a>
                    <a href="" class="far fa-share-square"></a>
                </div> -->
              </div>
              <div class="col-sm-3 col-md-3 col-xs-12">
                <h3>Weather</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                <h3>Pollen</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>

              </div>
            </div>
          </div>
          
    <div>

    </div>
</div>



<!-- footer is same as header -->
<footer>
    <h3 align="center">Visitors have clicked on news tiles <span id="click-value" style="color:red;"></span> times!</h3>
</footer>  

    
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-database.js"></script>
<script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCo4xVWn7Ypizk-6VB6XjTeb2ewiqaryic",
            authDomain: "projectone-cbac5.firebaseapp.com",
            databaseURL: "https://projectone-cbac5.firebaseio.com",
            projectId: "projectone-cbac5",
            storageBucket: "projectone-cbac5.appspot.com",
            messagingSenderId: "31129312771",
            appId: "1:31129312771:web:8a5072bcf95acf7dfcf836"
        };
          
        // Initialize Firebase
firebase.initializeApp(firebaseConfig);
var database = firebase.database();
//make auth and firestore reference
const auth = firebase.auth();
const db = firebase.firestore();

//counter when user click on any part of the main content
var clickCounter = 0;

$("#main-content").on("click", function() {

// Add to clickCounter
clickCounter++;

//  Store Click Data to Firebase in a JSON property called clickCount
// Note how we are using the Firebase .set() method
database.ref().set({
  clickCount: clickCounter
});
});

//counter snapshot codes
database.ref().on("value", function(snapshot) {

// Then we console.log the value of snapshot
console.log(snapshot.val());

// Update the clickCounter variable with data from the database.
clickCounter = snapshot.val().clickCount;

// Then we change the html associated with the number.
$("#click-value").text(clickCounter);

// If there is an error that Firebase runs into -- it will be stored in the "errorObject"
// Again we could have named errorObject anything we wanted.
}, function(errorObject) {

// In case of error this will print the error
console.log("The read failed: " + errorObject.code);
});


//update firestore settings
//db.setting({timestampsINSnapshots: true});
</script>
<script type="text/javascript" src="./auth.js"></script>

</body>
<script>
//Populate the home page with headlines
//Using the headlines query url, this is for only the population of the home page

var queryURL = "https://newsapi.org/v2/top-headlines?country=us&category=general&pageSize=10&apiKey=349152e2740748f4b23c31609ae25dae";





$(document).ready (function(){       
   query();
    });

    function query(){
        
        $.ajax({
    url: queryURL,
    method: "GET"
  }).then(function(response){

var results = response.articles;
console.log(results);

for(var i =0;i<results.length;i++){
var title = results[i].title;

console.log(title);
var content = results[i].description; //brief description of the news
var newsUrl = results[i].url; //link to the news on the news site
var imageUrl = results[i].urlToImage; //link to the news image;
console.log("URL: ",newsUrl);
console.log("Brief Description: ", content);
console.log("Image URL: ",imageUrl)
var myCol = $('<div class="grow col-sm-3 col-md-3 col-xs-12" id="col'+i+'"></div>'); //make a column
var card = $('<div class="card " id="'+i+'col"><div class="card-body>');
var cardHeader = $('<div class="card-header bg-secondary"><img src="'+imageUrl+'" class="card-img-top"></div>')
// var cardImage = $('<img src="'+imageUrl+'" class="card-img-top" style="height:20px;width:10px;"><br>')
var cardBody= $('<div class="card-body">');
var cardTitle = $('<div class="card-title"><span>'+title+'</span>')
var cardText = $ ('<div class="card-text">').text(content);
var readMore = $('<div><span class="read"><a class= "read" href="'+newsUrl+'">Read more..</a></span></div><div class="action-container"><a href="" class="far fa-bookmark"></a><a href="" class="far fa-share-square"></a></div>');

card.append(cardHeader);
// cardHeader.append(cardImage);
cardHeader.append(cardTitle);
cardTitle.append(cardText);
cardText.append(readMore);
myCol.append(card);
$(".row").append(myCol);

$('.close').on('click', function(e){
      e.stopPropagation();  
          var $target = $(this).parents('.col-sm-3');
          $target.hide('slow', function(){ $target.remove(); });
    });

$(".read").click(function(e){
    e.stopPropagation(); 
window.open(newsUrl,'_blank');
})
}
  });
    }

</script>

</html>

